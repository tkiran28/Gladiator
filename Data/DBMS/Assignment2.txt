20--Assignments Joins/Subqueries

1) List names ,jobs and deptno of the employee who are having the same job as that of the any empls of dept 20 and sort them in ascending order by deptno.
*select ename,job,deptno from emp where  job in ( select job from emp where deptno=20)order by deptno 





2) List the above details without showing dept no 20.

*select ename,job,deptno from emp where  job not in ( select job from emp where deptno=20)order by deptno 






3) List the names , deptno and dept name for all the employees.
* select e.ename,e.deptno,d.dname from emp e
join
dept d on e.deptno = d.deptno
*select ename,deptno,dname from emp 
join
dept d 
using(deptno)

4) List the name,job deptno and dname for all employees who work in Dallas.
*select ename,deptno,dname from emp 
join
dept d 
using(deptno)
where loc='DALLAS'


5) List the name, job , deptno that has no employees.
*SELECT e.ename, e.job, d.dname,d.deptno
   FROM dept d, emp e
   WHERE e.deptno(+)=d.deptno AND e.empno IS NULL


6) List the employee name , dept name and location of all empls who earn commission.
*SELECT e.ename, d.dname,d.loc
   FROM dept d, emp e
   WHERE e.deptno = d.deptno and e.comm is not null




7) List the employee details who earn highest salary for their job.
*Select * from emp where sal in (Select max(sal) from emp group by job)


8) List the name and hiredate of any empls hired after the employee Blake.
*select ename,hiredate from emp where hiredate > ( select hiredate from emp where ename='BLAKE')

9) List the lowest paid empl who are getting 3 min salaries and sort the result by sal in ascending order.
*select * from emp
where rownum < 4 
order by sal desc



10) List the no of people with the each job type.
*  select count(ename) ,job from emp group by job

11) List the deptname , location Name , no of empls and their average salary for the all empls in that dept and label the columns count(*) as number of people and salary.
*select dname,loc,count(ename),round(avg(sal)) from emp e,dept d
where d.deptno=e.deptno
group by dname,loc